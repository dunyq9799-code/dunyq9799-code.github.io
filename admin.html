<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DUNYA PRINT | Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <style>
    body {
      font-family: 'Sarabun', sans-serif;
      background-color: #FDFBF8;
      color: #4B4B4B;
    }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #EADFC7; padding: 8px; text-align: left; }
    th { background-color: #FFF9EF; color: #855E00; }
    tr:nth-child(even) { background-color: #FFFDF9; }
  </style>
</head>
<body class="min-h-screen">

  <!-- üîê Login Section -->
  <section id="login-section" class="flex flex-col items-center justify-center h-screen text-center">
    <h1 class="text-3xl font-semibold text-amber-800 mb-4">DUNYA PRINT</h1>
    <p class="text-gray-500 mb-6">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô</p>
    <input id="password" type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" class="border border-amber-200 rounded-lg px-4 py-2 mb-4 text-center">
    <button id="login-btn" class="bg-amber-500 text-white px-6 py-2 rounded-lg hover:bg-amber-600 transition">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
    <p id="login-error" class="text-red-500 mt-4 hidden">‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
  </section>

  <!-- üß≠ Admin Panel -->
  <section id="admin-section" class="hidden max-w-6xl mx-auto py-12 px-6">
    <h2 class="text-2xl font-medium text-amber-700 mb-8 text-center">Admin Dashboard</h2>

    <!-- üìä Dashboard Summary -->
    <div class="bg-amber-50 border border-amber-100 rounded-xl p-8 text-center shadow-inner mb-10">
      <h3 class="text-xl font-semibold text-amber-700 mb-6">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
        <div><p class="text-3xl font-bold text-amber-600" id="stat-products">0</p><p class="text-gray-500">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p></div>
        <div><p class="text-3xl font-bold text-amber-600" id="stat-packages">0</p><p class="text-gray-500">‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p></div>
        <div><p class="text-3xl font-bold text-amber-600" id="stat-discounted">0</p><p class="text-gray-500">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤</p></div>
        <div><p class="text-3xl font-bold text-amber-600" id="stat-expired">0</p><p class="text-gray-500">‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏´‡∏°‡∏î‡πÇ‡∏õ‡∏£</p></div>
      </div>
    </div>

    <!-- üõçÔ∏è ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
    <div class="bg-white border border-amber-100 rounded-xl p-6 mb-10 shadow-sm">
      <h3 class="text-xl font-semibold text-amber-700 mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</h3>
      <form id="product-form" class="grid gap-4 md:grid-cols-2">
        <input id="product-name" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" class="border rounded-lg px-4 py-2">
        <input id="product-price" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)" class="border rounded-lg px-4 py-2">
        <input id="product-discount" type="number" placeholder="‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (%)" class="border rounded-lg px-4 py-2">
        <input id="product-image" type="url" placeholder="URL ‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" class="border rounded-lg px-4 py-2 md:col-span-2">
        <button type="button" id="add-product" class="bg-amber-500 text-white px-6 py-2 rounded-lg hover:bg-amber-600 transition md:col-span-2">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
      </form>

      <h3 class="text-lg font-semibold text-amber-700 mt-10 mb-3">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
      <div class="overflow-x-auto">
        <table id="product-table">
          <thead>
            <tr><th>‡∏£‡∏π‡∏õ</th><th>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th><th>‡∏£‡∏≤‡∏Ñ‡∏≤</th><th>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</th><th>‡∏•‡∏ö</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <!-- üéÅ ‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à -->
    <div class="bg-white border border-amber-100 rounded-xl p-6 mb-10 shadow-sm">
      <h3 class="text-xl font-semibold text-amber-700 mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏™‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°</h3>
      <form id="package-form" class="grid gap-4 md:grid-cols-2">
        <input id="package-name" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à" class="border rounded-lg px-4 py-2">
        <input id="package-price" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)" class="border rounded-lg px-4 py-2">
        <input id="package-discount" type="number" placeholder="‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (%)" class="border rounded-lg px-4 py-2">
        <input id="package-end" type="date" class="border rounded-lg px-4 py-2">
        <input id="package-image" type="url" placeholder="URL ‡∏£‡∏π‡∏õ‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à" class="border rounded-lg px-4 py-2 md:col-span-2">
        <button type="button" id="add-package" class="bg-amber-500 text-white px-6 py-2 rounded-lg hover:bg-amber-600 transition md:col-span-2">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à</button>
      </form>

      <h3 class="text-lg font-semibold text-amber-700 mt-10 mb-3">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à</h3>
      <div class="overflow-x-auto">
        <table id="package-table">
          <thead>
            <tr><th>‡∏£‡∏π‡∏õ</th><th>‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à</th><th>‡∏£‡∏≤‡∏Ñ‡∏≤</th><th>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</th><th>‡∏´‡∏°‡∏î‡πÄ‡∏Ç‡∏ï</th><th>‡∏•‡∏ö</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <script>
    // üîß Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyAhky9wrqgm7r6BAJqYq4zo92aiV9_2Gyw",
      authDomain: "dunyaprint-shop.firebaseapp.com",
      databaseURL: "https://dunyaprint-shop-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "dunyaprint-shop",
      storageBucket: "dunyaprint-shop.firebasestorage.app",
      messagingSenderId: "78107878309",
      appId: "1:78107878309:web:a57a377b28ff884e2e3e4c"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // üîê Login
    document.getElementById("login-btn").onclick = () => {
      const pass = document.getElementById("password").value.trim();
      if (pass === "dunya2025") {
        document.getElementById("login-section").classList.add("hidden");
        document.getElementById("admin-section").classList.remove("hidden");
        loadData();
      } else {
        document.getElementById("login-error").classList.remove("hidden");
      }
    };

    // üõçÔ∏è Add Product
    document.getElementById("add-product").onclick = () => {
      const name = document.getElementById("product-name").value;
      const price = parseFloat(document.getElementById("product-price").value);
      const discount = parseInt(document.getElementById("product-discount").value) || 0;
      const image = document.getElementById("product-image").value;
      if (!name || !price) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤");
      db.ref("products").push({ name, price, discount, image });
      alert("‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!");
      document.getElementById("product-form").reset();
      loadData();
    };

    // üéÅ Add Package
    document.getElementById("add-package").onclick = () => {
      const name = document.getElementById("package-name").value;
      const price = parseFloat(document.getElementById("package-price").value);
      const discount = parseInt(document.getElementById("package-discount").value) || 0;
      const endDate = document.getElementById("package-end").value;
      const image = document.getElementById("package-image").value;
      if (!name || !price) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤");
      db.ref("packages").push({ name, price, discount, endDate, image });
      alert("‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!");
      document.getElementById("package-form").reset();
      loadData();
    };

    // üìä Load Data
    function loadData() {
      const productTable = document.querySelector("#product-table tbody");
      const packageTable = document.querySelector("#package-table tbody");

      db.ref("products").once("value", snap => {
        const data = snap.val() || {};
        const items = Object.entries(data);
        productTable.innerHTML = items.map(([id, p]) => `
          <tr>
            <td>${p.image ? `<img src="${p.image}" class="w-16 h-16 object-cover rounded">` : "-"}</td>
            <td>${p.name}</td>
            <td>${p.price}</td>
            <td>${p.discount || 0}%</td>
            <td><button onclick="deleteItem('products','${id}')" class="text-red-500 hover:text-red-700">üóëÔ∏è ‡∏•‡∏ö</button></td>
          </tr>`).join("");
        document.getElementById("stat-products").textContent = items.length;
        document.getElementById("stat-discounted").textContent = items.filter(([_, p]) => p.discount > 0).length;
      });

      db.ref("packages").once("value", snap => {
        const data = snap.val() || {};
        const items = Object.entries(data);
        packageTable.innerHTML = items.map(([id, p]) => `
          <tr>
            <td>${p.image ? `<img src="${p.image}" class="w-16 h-16 object-cover rounded">` : "-"}</td>
            <td>${p.name}</td>
            <td>${p.price}</td>
            <td>${p.discount || 0}%</td>
            <td>${p.endDate || "-"}</td>
            <td><button onclick="deleteItem('packages','${id}')" class="text-red-500 hover:text-red-700">üóëÔ∏è ‡∏•‡∏ö</button></td>
          </tr>`).join("");
        document.getElementById("stat-packages").textContent = items.length;
        const expired = items.filter(([_, p]) => p.endDate && new Date(p.endDate) < new Date()).length;
        document.getElementById("stat-expired").textContent = expired;
      });
    }

    // üóëÔ∏è Delete
    function deleteItem(type, id) {
      if (confirm("‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ?")) {
        db.ref(`${type}/${id}`).remove();
        alert("‚úÖ ‡∏•‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
        loadData();
      }
    }
  </script>
</body>
</html>
