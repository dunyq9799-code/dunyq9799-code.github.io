<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DUNYA PRINT | Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600&display=swap" rel="stylesheet">
  <script type="module">
    // ============================
    // Firebase Config (‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
    // ============================
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
    import { getDatabase, ref, get, set, push, remove } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAhky9wrqgm7r6BAJqYq4zo92aiV9_2Gyw",
      authDomain: "dunyaprint-shop.firebaseapp.com",
      databaseURL: "https://dunyaprint-shop-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "dunyaprint-shop",
      storageBucket: "dunyaprint-shop.firebasestorage.app",
      messagingSenderId: "78107878309",
      appId: "1:78107878309:web:a57a377b28ff884e2e3e4c",
      measurementId: "G-P4BHPCHK87"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // ============================
    // ‡∏£‡∏´‡∏±‡∏™‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÜ
    // ============================
    function login() {
      const pass = document.getElementById("password").value;
      if (pass === "dunya2025") {
        document.getElementById("login-section").classList.add("hidden");
        document.getElementById("admin-section").classList.remove("hidden");
        loadDashboard();
      } else {
        alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚ùå");
      }
    }

    // ============================
    // ‡πÇ‡∏´‡∏•‡∏î Dashboard Summary
    // ============================
    async function loadDashboard() {
      const productsRef = ref(db, "products");
      const packagesRef = ref(db, "packages");
      const productsSnap = await get(productsRef);
      const packagesSnap = await get(packagesRef);

      let products = productsSnap.exists() ? Object.values(productsSnap.val()) : [];
      let packages = packagesSnap.exists() ? Object.values(packagesSnap.val()) : [];

      const totalProducts = products.length;
      const totalPackages = packages.length;
      const discounted = products.filter(p => p.discount && p.discount > 0).length;
      const expiredPackages = packages.filter(p => new Date(p.endDate) < new Date()).length;

      animateValue("stat-products", 0, totalProducts, 1000);
      animateValue("stat-packages", 0, totalPackages, 1000);
      animateValue("stat-discounted", 0, discounted, 1000);
      animateValue("stat-expired", 0, expiredPackages, 1000);
    }

    // ============================
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏±‡∏ö‡πÄ‡∏•‡∏Ç (‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô)
    // ============================
    function animateValue(id, start, end, duration) {
      if (start === end) return;
      const range = end - start;
      const increment = end > start ? 1 : -1;
      const stepTime = Math.abs(Math.floor(duration / range));
      let current = start;
      const obj = document.getElementById(id);
      const timer = setInterval(() => {
        current += increment;
        obj.textContent = current;
        if (current == end) clearInterval(timer);
      }, stepTime);
    }

    // ============================
    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà
    // ============================
    async function addProduct() {
      const name = document.getElementById("product-name").value;
      const price = parseFloat(document.getElementById("product-price").value);
      const discount = parseInt(document.getElementById("product-discount").value) || 0;
      const image = document.getElementById("product-image").value;

      if (!name || !price) return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏∞");

      const newRef = push(ref(db, "products"));
      await set(newRef, { name, price, discount, image });
      alert("‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!");
      document.getElementById("product-form").reset();
      loadDashboard();
    }

    // ============================
    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡πÉ‡∏´‡∏°‡πà
    // ============================
    async function addPackage() {
      const name = document.getElementById("package-name").value;
      const price = parseFloat(document.getElementById("package-price").value);
      const discount = parseInt(document.getElementById("package-discount").value) || 0;
      const endDate = document.getElementById("package-end").value;
      const image = document.getElementById("package-image").value;

      if (!name || !price) return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏∞");

      const newRef = push(ref(db, "packages"));
      await set(newRef, { name, price, discount, endDate, image });
      alert("‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!");
      document.getElementById("package-form").reset();
      loadDashboard();
    }
  </script>
  <style>
    body {
      font-family: 'Sarabun', sans-serif;
      background-color: #FDFBF8;
      color: #4B4B4B;
    }
  </style>
</head>
<body class="min-h-screen">
  <!-- üîê Login Section -->
  <section id="login-section" class="flex flex-col items-center justify-center h-screen text-center">
    <h1 class="text-3xl font-semibold text-amber-800 mb-4">DUNYA PRINT</h1>
    <p class="text-gray-500 mb-6">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô</p>
    <input id="password" type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" class="border border-amber-200 rounded-lg px-4 py-2 mb-4 text-center">
    <button onclick="login()" class="bg-amber-500 text-white px-6 py-2 rounded-lg hover:bg-amber-600 transition">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
  </section>

  <!-- üß≠ Admin Panel -->
  <section id="admin-section" class="hidden max-w-5xl mx-auto py-12 px-6">
    <h2 class="text-2xl font-medium text-amber-700 mb-8 text-center">Admin Dashboard</h2>

    <!-- Tabs -->
    <div class="flex space-x-4 justify-center mb-8">
      <button onclick="document.getElementById('product-form').scrollIntoView({behavior:'smooth'})"
              class="bg-amber-100 text-amber-800 px-6 py-2 rounded-lg hover:bg-amber-200 transition">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
      <button onclick="document.getElementById('package-form').scrollIntoView({behavior:'smooth'})"
              class="bg-amber-100 text-amber-800 px-6 py-2 rounded-lg hover:bg-amber-200 transition">‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à</button>
    </div>

    <!-- Product Form -->
    <div class="bg-white border border-amber-100 rounded-xl p-6 mb-10 shadow-sm">
      <h3 class="text-xl font-semibold text-amber-700 mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</h3>
      <form id="product-form" class="grid gap-4 md:grid-cols-2">
        <input id="product-name" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" class="border rounded-lg px-4 py-2">
        <input id="product-price" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)" class="border rounded-lg px-4 py-2">
        <input id="product-discount" type="number" placeholder="‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (%)" class="border rounded-lg px-4 py-2">
        <input id="product-image" type="url" placeholder="URL ‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" class="border rounded-lg px-4 py-2 md:col-span-2">
        <button type="button" onclick="addProduct()" class="bg-amber-500 text-white px-6 py-2 rounded-lg hover:bg-amber-600 transition md:col-span-2">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
      </form>
    </div>

    <!-- Package Form -->
    <div class="bg-white border border-amber-100 rounded-xl p-6 mb-10 shadow-sm">
      <h3 class="text-xl font-semibold text-amber-700 mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏™‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°</h3>
      <form id="package-form" class="grid gap-4 md:grid-cols-2">
        <input id="package-name" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à" class="border rounded-lg px-4 py-2">
        <input id="package-price" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)" class="border rounded-lg px-4 py-2">
        <input id="package-discount" type="number" placeholder="‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (%)" class="border rounded-lg px-4 py-2">
        <input id="package-end" type="date" class="border rounded-lg px-4 py-2">
        <input id="package-image" type="url" placeholder="URL ‡∏£‡∏π‡∏õ‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à" class="border rounded-lg px-4 py-2 md:col-span-2">
        <button type="button" onclick="addPackage()" class="bg-amber-500 text-white px-6 py-2 rounded-lg hover:bg-amber-600 transition md:col-span-2">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à</button>
      </form>
    </div>

    <!-- üìä Dashboard Summary -->
    <div class="bg-amber-50 border border-amber-100 rounded-xl p-8 text-center shadow-inner">
      <h3 class="text-xl font-semibold text-amber-700 mb-6">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
        <div>
          <p class="text-3xl font-bold text-amber-600" id="stat-products">0</p>
          <p class="text-gray-500">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
        </div>
        <div>
          <p class="text-3xl font-bold text-amber-600" id="stat-packages">0</p>
          <p class="text-gray-500">‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
        </div>
        <div>
          <p class="text-3xl font-bold text-amber-600" id="stat-discounted">0</p>
          <p class="text-gray-500">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤</p>
        </div>
        <div>
          <p class="text-3xl font-bold text-amber-600" id="stat-expired">0</p>
          <p class="text-gray-500">‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏´‡∏°‡∏î‡πÇ‡∏õ‡∏£</p>
        </div>
      </div>
    </div>
  </section>
</body>
</html>
